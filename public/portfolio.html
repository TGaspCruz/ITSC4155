<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>portfolio</title>
    <link rel="stylesheet" href="portfolio.css">
</head>
<body>
    <header>
        <h1 id="username">&#128188 Portfolio</h1>
        <nav>
            <a href="dashboard.html">Dashboard</a>
            <button id="logoutBtn">Logout</button>
        </nav>
    </header>
    <main>
        <section>
            <h2>Available Funds</h2>
            <p id="available-funds"></p>
        </section>
        <section>
            <h2>Stock Holdings</h2>
            <div>
            <table id="holdings-table" border="1" cellpadding="6">
                <thead>
                    <tr>
                        <th>Ticker</th>
                        <th>Quantity</th>
                        <th>Avg Price</th>
                        <th>Market Value</th>
                    </tr>
                </thead>
                <tbody id="holdings-body">
                </tbody>
            </table>
            </div>
        </section>
    </main>
</body>

<script>

    
    
    
    async function getFunds() {
  
  
  
  const res = await fetch("/api/getFunds");
  const data = await res.json();
  if (data.success) {
    document.getElementById("available-funds").textContent = data.availableFunds;
    
  } else {
    console.error("Failed to fetch funds:", data.message);
  }
}

async function getStocks() {
  const res = await fetch("/api/getStocks");
  const data = await res.json();
  if (data.success) {
    const tbody = document.getElementById("holdings-body");
    tbody.innerHTML = ""; 

    data.stocks.forEach(stock => {
      const marketValue = (stock.quantity * stock.avgPrice).toFixed(2);
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>${stock.ticker}</td>
        <td>${stock.quantity}</td>
        <td>${stock.avgPrice.toFixed(2)}</td>
        <td>${marketValue}</td>
      `;

      tbody.appendChild(row);
    });
  } else {
    console.error("Failed to fetch stocks:", data.message);
  }
}


window.addEventListener("load", () => {
  getFunds();
  getStocks();
});

</script>
</html>